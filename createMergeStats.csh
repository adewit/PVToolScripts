#!/bin/tcsh

set folder=$1
set IOVbegin=(272007 273725 274244 274335 274420 274442 274998 275068 275309 275344 275376 275783 275847 275920 276242 276283 276363 276454 276501 276525 276581 276653 276776 276811 276870 276950 277076 277096 277168 277218 278018 278240 278315 278406 278803 278820 278957 278975 279588 279667 279715 279766 279841 279931 280015 280191 280330 280385 281693 281797 282037 282731 282807 283041 283270 283308 283408 283553 283830 283877 283934 284029 284044)
set IOVend  =(273725 274244 274335 274420 274442 274998 275068 275309 275344 275376 275783 275847 275920 276242 276283 276363 276454 276501 276525 276581 276653 276776 276811 276870 276950 277076 277096 277168 277218 278018 278240 278315 278406 278803 278820 278957 278975 279588 279667 279715 279766 279841 279931 280015 280191 280330 280385 281693 281797 282037 282731 282807 283041 283270 283308 283408 283553 283830 283877 283934 284029 284044 300000)

foreach i (`seq $#IOVbegin`)

    set listToAdd=''

    foreach file (`ls ./$folder | grep PVValidation | grep root`)
	#echo $folder/$file
	set date=`echo $file | awk '{split($0,a,"_"); print a[3]}'`
	#echo $date
	set theDate=`echo $date |awk '{split($0,c,"."); print c[1]}'`

	#echo $theDate
	#echo $i $IOVbegin[$i] $IOVend[$i]

	if(($theDate == $IOVbegin[$i]) || ($theDate>$IOVbegin[$i] && $theDate<$IOVend[$i])) then
	   #echo $listToAdd
	   set listToAdd = "$listToAdd $folder/$file" 
	endif 
    end

    echo "========================================================="
    echo "IOVbegin: $IOVbegin[$i], IOVend: $IOVend[$i]| $listToAdd"
    hadd PVValidation_${folder}_$IOVbegin[$i]-$IOVend[$i]_IOV_$i.root $listToAdd
end
